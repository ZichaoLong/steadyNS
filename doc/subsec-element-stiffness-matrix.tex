\subsection{Element Stiffness Matrix}
Without loss of generality, we assume that $e_k=\{i_j\}_{j=0}^{(d+1)(d+2)/2}$.
We denote $\lambda^j(x)$ as the barycentric coordinate with respect to 
the node $A_{i_j}$ of $e_k$. 
We denote $\lambda^j_2(x)$ as the basis function with respect to 
the node/edge $A_{i_j}$.
Apparently the basis function $v_{i_j}$ is equal to $\lambda^j_2$ in $e_k$.

Meanwhile, for functions $u_h^{n-1},u_h^n$ 
and $f_h=f_iv_i,u_h=\alpha_iv_i$, 
in the sense of Einstein summation notations
\footnote{We assume $f\in H^1(\Omega)$}, 
we denote that the tensors in $\mr^{(d+1)(d+2)/2\times d}$
\[
  \begin{split}
    F_k=[f_{i_j}]_{j=0}^{(d+1)(d+2)/2},& U_k=[\alpha_{i_j}]_{j=0}^{(d+1)(d+2)/2},\\
    U_{k}^{n}=[\alpha_{i_j}^{n}]_{j=0}^{(d+1)(d+2)/2}, &
    U_{k}^{n-1}=[\alpha_{i_j}^{n-1}]_{j=0}^{(d+1)(d+2)/2} 
  \end{split}
\]

It is easy to know that for $x\in e_k$, $f_h(x),u_h(x)$ can be represented by 
the basis functions $\lambda_2(x)\in\mr^{(d+1)(d+2)/2}$
\[f_h(x)=F_k\cdot\lambda_2(x),u_h(x)=U_k\cdot\lambda_2(x)\]
and so do $u_h^{n-1},u_h^n$. 

\textbf{From now on}, we will study element stiffness matrix when we apply 
a set of test functions $v^{j,l}:e_k\to\mr^{d}$ and 
$q_k-q_k$, where
\[v^{j,l}(x)=\lambda_2^j(x)\alpha^l\in\mr^{d},l=0,\cdots,d-1,j=0,\cdots,(d+1)(d+2)/2-1,\]

\subsubsection{Right Hand Items}
\paragraph{$\bm{\int_{e_k}v^{j_0,l}(x)\cdot f(x)\ud x}$}
At first, by using Eq.\eqref{eq:integral-uv}, for 
$l=0,\cdots,d-1,j=0,\cdots,(d+1)(d+2)/2$ we have
\begin{equation}
  \int_{e_k}v^{j_0,l}\cdot f\ud x = |e_k|\cdot \sum_{j_1}VU_{4s}[j_0,j_1]F_k[j_1,l]
\end{equation}

\paragraph{$\bm{-\int_{e_k}v^{j_0,l}(x)\cdot(u_h^{n-1}(x)\cdot\nabla)
u_h^{n-1}(x)\ud x
\text{ and }-\frac{1}{2}\int_{e_k}(\nabla\cdot u_h^{n-1}(x))v^{j_0,l}(x)
\cdot u_h^{n-1}(x)\ud x}$}
Similarly, for $l=0,\cdots,d-1,j=0,\cdots,(d+1)(d+2)/2$ we obtain
\begin{equation}
  \begin{split}
    -\int_{e_k} v^{j_0,l}(x)\cdot(u_h^{n-1}(x)\cdot\nabla)u_h^{n-1}(x)\ud x
    &= -|e_k|\sum_iW_5[i]\cdot\Gamma_5[i,j_0]\cdot
    \sum_{l1}U_n[i,l1]\cdot GU_n[i,l,l1] \\
    -\frac12\int_{e_k}(\nabla\cdot u_h^{n-1}(x))v^{j_0,l}(x)\cdot u_h^{n-1}(x)\ud x
    &= -\frac{|e_k|}2\sum_iW_5[i]\cdot\sum_{l1}GU_n[i,l1,l1]
    \cdot \Gamma_5[i,j0] \cdot U_n[i,l]
  \end{split}
\end{equation}

\subsubsection{Stiffness Matrix}
\paragraph{$\bm{\nu\int_{e_k}\nabla u_h^n(x):\nabla v^{j_0,l}(x)\ud x}$} 
By using Eq.\eqref{eq:integral-gugv}, 
for $l=0,\cdots,d-1,j=0,\cdots,(d+1)(d+2)/2$ we obtain
\begin{equation}
    \nu\int_{e_k} \nabla u_h^n:\nabla v^{j_0,l}\ud x = \nu|e_k| \sum_{j_1} 
    \sum_{i,l'}W_2[i]\Theta_2^{e_k}[i,j_0,l']\Theta_2^{e_k}[i,j_1,l'] 
    \cdot U^n_k[j_1,l]
\end{equation}

\paragraph{$\bm{-\int_{e_k}p_h^n(x)\nabla\cdot v^{j_0,l}(x)\ud x}$}
It is easy to see
\begin{equation}
    -\int_{e_k} p_h^n\nabla\cdot v^{j_0,l}\ud x
    = -|e_k| \beta^n_k\sum_i W_1[i] \Theta_1^{e_k}[i,j_0,l]
\end{equation}

\paragraph{$\bm{\int_{\Omega}(q_k(x)-q_{k-1}(x))\nabla\cdot u_h^n(x)\ud x=0}$}
\begin{equation}
  \begin{split}
    \int_\Omega(q_k(x)-q_{k-1}(x))\nabla\cdot u_h^n\ud x &=
    \big(\frac1{|e_k|}\int_{e_k}-\frac1{|e_{k-1}|}\int_{e_{k-1}}\big)
    \nabla \cdot u_h^n\ud x \\
    &= \sum_{j,l}\sum_{i} W_i[i]\Theta_1^{e_k}[i,j,l]\cdot U_k^n[j,l] 
    -\sum_{j,l}\sum_{i} W_i[i]\Theta_1^{e_{k-1}}[i,j,l]\cdot U_{k-1}^n[j,l]
  \end{split}
\end{equation}

\newpage
\subsubsection{Stiffness Matrix and Right Hand Items}
\[
  \begin{split}
        U_n[i,l] &= u^l(\Lambda_n[i])=\sum_j \Gamma_n[i,j]u[j,l], \\
    GU_n[i,l,l'] &= \nabla_{l'} u^l(\Lambda_n[i])=\sum_j \Theta_n^e[i,j,l']u[j,l],
    l'=0,\cdots,d-1
  \end{split}
\]
\paragraph{$\bm{\nu\int_{e_k}\nabla u_h(x):\nabla v^{j_0,l}(x)\ud x}$} 
\[
    \nu\int_{e_k} \nabla u_h:\nabla v^{j_0,l}\ud x = \nu|e_k| \sum_{j_1} 
    \sum_{i,l'}W_2[i]\Theta_2^{e_k}[i,j_0,l']\Theta_2^{e_k}[i,j_1,l'] 
    \cdot U_k[j_1,l]
\]
\paragraph{$\bm{-\int_{e_k}p_h(x)\nabla\cdot v^{j_0,l}(x)\ud x}$}
\[
    -\int_{e_k} p_h^n\nabla\cdot v^{j_0,l}\ud x
    = -|e_k| \beta_k\sum_i W_1[i] \Theta_1^{e_k}[i,j_0,l]
\]
\paragraph{$\bm{-\int_{\Omega}q_k(x)\nabla\cdot u_h(x)\ud x=0}$}
\[
    -\int_\Omega q_k(x)\nabla\cdot u_h\ud x =
    = -|e_k| \sum_{j,l}\sum_i W_1[i] \Theta_1^{e_k}[i,j,l] \cdot U_k[j,l]
\]


\paragraph{$\bm{\int_{e_k}v^{j_0,l}(x)\cdot f(x)\ud x}$}
\[
  \int_{e_k}v^{j_0,l}\cdot f\ud x = |e_k|\cdot \sum_{j_1}VU_{4s}[j_0,j_1]F_k[j_1,l]
\]

\paragraph{$\bm{\int_{e_k}v^{j_0,l}(x)\cdot(u_h(x)\cdot\nabla)
u_h^+(x)\ud x}$}
\[
  \begin{split}
    \int_{e_k} v^{j_0,l}(x)\cdot(u_h(x)\cdot\nabla)u_h^+(x)\ud x
    &= |e_k|\sum_iW_5[i]\cdot\Gamma_5[i,j_0]\cdot
    \sum_{l1}U_5[i,l1]\cdot GU_5^+[i,l,l1] \\
    &= |e_k|\sum_iW_5[i]\cdot\Gamma_5[i,j_0]\cdot
    \sum_{l1} \sum_{j1}\Gamma_5[i,j1] u[j1,l1] \cdot \sum_{j2}\Theta_5^{e_k}[i,j2,l1]u^+[j2,l]
  \end{split}
\]

\subsubsection{Iterative Methods}
Stokes
\[
  \begin{split}
    -\nu \Delta u^++\nabla p^++ (u\cdot\nabla)u &= f\\
    \nabla\cdot u^+&=0
  \end{split}
\]
Newton
\[
  \begin{split}
    -\nu \Delta u^++\nabla p^++ (u^+\cdot\nabla)u+(u\cdot\nabla)u^+&= f+(u\cdot\nabla)u \\
    \nabla\cdot u^+&=0
  \end{split}
\]
Oseen
\[
  \begin{split}
    -\nu \Delta u^++\nabla p^++ (u\cdot\nabla)u^+&= f \\
    \nabla\cdot u^+&=0
  \end{split}
\]
