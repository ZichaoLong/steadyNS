\subsection{Element Stiffness Matrix}
Without loss of generality, we assume that $e_k=\{i_j\}_{j=0}^d$, 
and we denote $\lambda^j(x)$ as the barycentric coordinate with respect to $A_{i_j}$ for $e_k$. 
Apparently the basis function $v_{i_j}$ is equal to $\lambda^j$ in $e_k$.

We use $\Lambda=\big[\lambda_i^j\big]\in\mr^{\text{nQuad}\times(d+1)}$
to represent the quadrature points of order 2
(see Tab.\ref{tab:quadrature-points-2d} and Tab.\ref{tab:quadrature-points-3d}). 
And for convenience of notation, two matrix $\Gamma,\Theta$ are introduced
\begin{equation*}
  \begin{split}
    \Gamma&=\big[W_i\lambda_i^j\big]=\text{diag}([W_i])\cdot\Lambda\in\mr^{\text{nQuad}\times(d+1)},\\
    \Theta&=\Lambda^\top\Gamma\in\mr^{(d+1)\times(d+1)}
  \end{split}
\end{equation*}
Meanwhile, for functions $u_h^{n-1},u_h^n$(See Eq.\eqref{eq:uf-linear-approximation}) and $f_h=f_iv_i,u_h=\alpha_iv_i$, 
in the sense of Einstein summation notations\footnote{We assume $f\in H^1(\Omega)$}, we denote that
\[
  F_k=[f_{i_j}]_{j=0}^{d},U_k=[\alpha_{i_j}]_{j=0}^d,
  U_{k}^{n-1}=[\alpha_{i_j}^{n-1}]_{j=0}^{d},
  U_{k}^{n}=[\alpha_{i_j}^{n}]_{j=0}^{d}\in\mr^{d\times(d+1)}
\]

It is easy to know that for $x\in e_k$, $f_h(x),u_h(x)$ can be represented by 
barycentric coordinates $\lambda(x)\in\mr^{d\times1}$
\[f_h(x)=F_k\cdot\lambda(x),u_h(x)=U_k\cdot\lambda(x)\]
and so do $u_h^{n-1},u_h^n$. It is also apparently that
$\nabla u_h(x)\in\mr^{d\times d}$ and as a consequence of Eq we know that
\begin{equation*}
  \begin{split}
  \nabla u_h(x)&=\sum_{j=0}^d\alpha_{i_j}\nabla\lambda^j(x)=\sum_{j=0}^d\alpha_{i_j}
\left(
\left[\begin{array}{c} 
  1 \\ 
  e_k 
\end{array}\right]^{-1}
\right)[j,1\text{:end}]
=[\alpha_{i_j}]_{j=0}^d\cdot
E_k \\
  &=U_k\cdot E_k,x\in e_k
  \end{split}
\end{equation*}
where $E_k=
\left[\begin{array}{c} 
  1 \\ 
  e_k 
\end{array}\right]^{-1}[:,1\text{:end}]\in\mr^{(d+1)\times d}.
$
Similarly, we have
\begin{equation}\label{eq:u-gradient}
  \nabla u_h^{n-1}=U_k^{n-1}\cdot E_k,
  \nabla u_h^{n}=U_k^n\cdot E_k, x\in e_k
\end{equation}
\textbf{From now on}, we will study element stiffness matrix when we apply 
a set of test functions $v^j_l:e_k\to\mr^{d\times1}$ and $q_k-q_0$ to the equation 
Eq.(\ref{eq:equation-testv-interior},~\ref{eq:equation-testv-period},~\ref{eq:equation-testq}) respectively, where
\[v^j_l(x)=\lambda^j(x)\alpha^l\in\mr^{d\times1},l=0,\cdots,d-1,j=0,\cdots,d,\]
in which $\alpha^l=[\alpha^l[l']]_{l'=0}^d\in\mr^{d\times1}$ was defined by Eq.\eqref{eq:basis-alpha}.
It is easy to know that $\nabla v^j_l(x)\in\mr^{d\times d}$ and
\[
  \nabla v^j_l(x)=\alpha^l\nabla\lambda^j(x)
  =\alpha^lE_k[j]
  \]

\subsubsection{Right Hand Items}
\paragraph{$\bm{\int_{e_k}v^j_l(x)^\top\cdot f(x)\ud x}$}
At first, by using Eq.\eqref{eq:quadrature-points-integral}, for $l=0,\cdots,d-1,j=0,\cdots,d$ we have 
\begin{equation}
  \begin{split}
    &\int_{e_k}v^j_l(x)^\top\cdot f(x)\ud x \\
    =&|e_k|\sum_{i=0}^{\text{nQuad}}
    {\textstyle W_iv^j_l(\sum_{j'=0}^{d}\lambda_i^{j'}e^{j'})\cdot f(\sum_{j'=0}^{d}\lambda_i^{j'}e^{j'})} \\
    =& |e_k|\sum_{i=0}^{\text{nQuad}}W_i\lambda_i^j(\alpha^l)^\top\cdot (F_k\cdot\Lambda[i,:]^\top) \\
    =& |e_k|\sum_{i=0}^{\text{nQuad}}W_i\lambda_i^j\Lambda[i,:]\cdot F_k^\top\cdot\alpha^l \\
    =& |e_k|\cdot\Gamma[:,j]^\top\cdot\Lambda\cdot F_k^\top\cdot\alpha^l \\
    =& |e_k|\cdot F_k[l,:]\cdot\Theta[:,j],
  \end{split}
\end{equation}

\paragraph{$\bm{-\int_{e_k}v^j_l(x)^\top\cdot(u_h^{n-1}(x)^\top\cdot\nabla)u_h^{n-1}(x)\ud x\text{ and }
  \frac{1}{2}\int_{e_k}(\nabla\cdot u_h^{n-1}(x))v^j_l(x)\cdot u_h^{n-1}(x)\ud x}$}
Similarly, by using Eq.(\ref{eq:quadrature-points-integral},~\ref{eq:u-gradient}), for $l=0,\cdots,d-1,j=0,\cdots,d$ we obtain
\begin{equation}
  \begin{split}
    &\int_{e_k}v^j_l(x)^\top\cdot(u_h^{n-1}(x)^\top\cdot\nabla)u_h^{n-1}(x)\ud x \\
    =& \int_{e_k}v^j_l(x)^\top\cdot(\nabla u_h^{n-1}(x))\cdot u_h^{n-1}(x)\ud x \\ 
    =& |e_k|\sum_{i=0}^{\text{nQuad}}W_i\lambda_i^j(\alpha^l)^\top
    \cdot U_k^{n-1}\cdot E_k
    \cdot U_k^{n-1}\cdot \Lambda[i,:]^\top, \\
    =& |e_k|(\alpha^l)^\top\cdot U_k^{n-1}\cdot E_k\cdot U_k^{n-1}\cdot
    \sum_{i=0}^{\text{nQuad}}\Lambda[i,:]^\top W_i\lambda_i^j \\
    =& |e_k|\cdot U_k^{n-1}[l,:]\cdot E_k\cdot U_k^{n-1}\cdot\Theta[:,j], 
  \end{split}
\end{equation}
\begin{equation}
  \int_{e_k}(\nabla\cdot u_h^{n-1}(x))v^j_l(x)\cdot u_h^{n-1}(x)\ud x
  =|e_k|\cdot\tr\big(U_k^{n-1}\cdot E_k\big)\cdot
  U_k^{n-1}[l,:]\cdot\Theta[:,j].
\end{equation}
where "$\tr$" means taking trace of a matrix.

\subsubsection{Stiffness Matrxi}
\paragraph{$\bm{\nu\int_{e_k}\nabla u_h^n(x):\nabla v^j_l(x)\ud x}$} 
By using Eq.\eqref{eq:u-gradient}, for $l=0,\cdots,d-1,j=0,\cdots,d$ we obtain
\begin{equation}
  \begin{split}
    &\int_{e_k}\nabla u_h^n(x):\nabla v^j_l(x)\ud x \\
    =& |e_k|\cdot U_k^n\cdot E_k:\alpha^l\cdot E_k[j] \\
    =& |e_k|\cdot U_k^n[l]\cdot E_k\cdot E_k[j]^\top
  \end{split}
\end{equation}

\paragraph{$\bm{-\int_{e_k}p_h^n(x)\nabla\cdot v^j_l(x)\ud x}$}
It is easy to see
\begin{equation}
  \int_{e_k}p_h^n(x)\nabla\cdot v^j_l(x)\ud x=\beta_k^n\tr(\nabla v^j_l)=\beta_k^nE_k[j,l] 
\end{equation}
\paragraph{$\bm{\int_{\Omega}(q_k(x)-q_{k-1}(x))\nabla\cdot u_h^n(x)\ud x=0}$}
\begin{equation}
  \begin{split}
    0&=\int_{\Omega}(q_k(x)-q_{k-1}(x))\nabla\cdot u_h^n(x)\ud x \\
    &=\int_{e_k}q_k(x)\nabla\cdot u_h^n(x)\ud x-\int_{e_{k-1}}q_{k-1}(x)\cdot u_h^n(x)\ud x \\
    &=\tr(U_k^n\cdot E_k)-\tr(U_{k-1}^n\cdot E_{k-1}),k=1,\cdots,M-1
  \end{split}
\end{equation}

