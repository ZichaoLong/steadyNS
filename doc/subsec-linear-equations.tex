\subsection{Linear Equations}
Now let us write down the linear equations for the variational form \eqref{eq:discrete-variational}
\[
  a(u_h^n,v)-d(v,p^n_h)+d(u_h^n,q)+b(u_h^{n-1},u_h^{n-1},v)=(f,v),\forall (v,q)\in(V_h,Q_h),
  \]
where, with notations of Einstein summation, the $u_h^{n-1},u_h^n,p_h^n$ reads as
\begin{equation}\label{eq:uf-linear-approximation}
  u_h^{n-1}=\alpha_i^{n-1}v_i,u_h^n=\alpha_i^nv_i,p_h^n=\beta_k^nq_k
\end{equation}
The variables to be solved are $\{\alpha_i^n\}_{i=0}^{N-1}$ and $\{\beta_i^n\}_{i=0}^{M-1}$, in each iteration, 
and in this sub-section we will talk about their corresponding equations in analytical form.
The details on how to construct element stiffness matrix and assemble global stiffness matrix 
will be introduced later.

\paragraph{Equations Derived from Boundary}
\begin{itemize}
  \item $\alpha_i=(1,0,0)^\top \text{ or } (1,0)^\top$ if $B_i=1$ or $2$
  \item $\alpha_i=(0,0,0)^\top \text{ or } (0,0)^\top$ if $B_i=3$
  \item $\alpha_i=\alpha_j,$ if $B_i=4$ and $P_i=j$, i.e. $j$ is the source node of $i$.
\end{itemize}

\paragraph{Equations Derived from Test Function $v_h$}
We denote $\alpha^l=[\alpha^l[l']]_{l'=0}^d\in\mr^{d\times1}$ where
\begin{equation}\label{eq:basis-alpha}
  \alpha^l[l']=\left\{
    \begin{array}{ll}
      0, & \text{if } l'\neq l \\
      1, & \text{if } l'=l
    \end{array}\right.,
\end{equation}
\begin{itemize}
  \item If $B_i=0$, then for all $\alpha=\alpha^l\in\mr^{d\times1},(l=0,\cdots,d-1)$ and $v=\alpha v_{i}$ we have
    \begin{equation}\label{eq:equation-testv-interior}
      \begin{split}
        &\sum_{e_{k}:i\in e_{k}}\int_{e_{k}}f(x)\cdot v(x)\ud x
        -\int_{e_{k}}(u_h^{n-1}(x)\cdot\nabla)u_h^{n-1}(x)\cdot v(x)+\frac{1}{2}(\nabla\cdot u_h^{n-1}(x))v(x)\cdot u_h^{n-1}(x)\ud x \\
        &=\sum_{e_{k}:i\in e_{k}}\nu\int_{e_{k}}\nabla u_h^n(x):\nabla v(x)\ud x-\int_{e_{k}}p_h^n(x)\nabla\cdot v(x)\ud x 
      \end{split}
    \end{equation}
  \item If $B_i=5$ and $i$ is the source of these nodes $\{j:P_j=i\}$, 
    then for $v=\alpha\sum_{i'=i\text{ or }i'\in\{j:P_j=i\}}v_{i'}$ the following equation shoudl be satisfied
    \begin{equation}\label{eq:equation-testv-period}
      \begin{split}
        &\sum_{e_{k}:i\text{ or }j\in e_{k}}\int_{e_{k}}f(x)\cdot v(x)\ud x
        -\int_{e_{k}}(u_h^{n-1}(x)\cdot\nabla)u_h^{n-1}(x)\cdot v(x)+\frac{1}{2}(\nabla\cdot u_h^{n-1}(x))v(x)\cdot u_h^{n-1}(x)\ud x \\
        &=\sum_{e_{k}:i\text{ or }j\in e_{k}}\nu\int_{e_{k}}\nabla u_h^n(x):\nabla v(x)\ud x-\int_{e_{k}}p_h^n(x)\nabla\cdot v(x)\ud x 
      \end{split}
    \end{equation}
    where $\sum_{e_{k}:i\text{ or }j\in e_{k}}$ means that $\sum_{e_k:(\{i\}\cup\{j:P_j=i\})\cap e_k\neq\varnothing}$
\end{itemize}

\paragraph{Equation for Uniqueness of Pressure} Since the pressure $p_h^n$ is determined only up to an additive constant, 
the additional condition for fixing the constant has to be introduced, 
i.e. that the integral mean value of the pressure should be vanish: $\int_\Omega p\ud x=0$. Thus we have a additional equation for $\{\beta_i\}$:
\[
  \sum_{i=0}^{N-1}\beta_i=0
  \]

\paragraph{Equations Derived from Test Function $q_k$} The $k$-th($k=1,\cdot,M-1$) test function is $q_k-q_{k-1}$ and 
\begin{equation}\label{eq:equation-testq}
  \int_{\Omega}(q_k(x)-q_{k-1}(x))\nabla\cdot u_h^n(x)\ud x=0
\end{equation}

